{
  "name": "container_image_vulnerability_on_kubernetes_cluster",
  "description": "This incident type refers to the discovery of a security vulnerability in a container image running on a Kubernetes cluster. Container images are commonly used to package and deploy software applications in a lightweight and portable way. Kubernetes is a popular platform for managing containerized applications. A vulnerability in a container image can potentially expose the application and the underlying infrastructure to security threats. This incident requires immediate attention to identify and remediate the vulnerability to prevent any further security breaches.",
  "params": [
    {
      "name": "DEPLOYMENT",
      "value": ""
    },
    {
      "name": "POD_NAME",
      "value": ""
    },
    {
      "name": "CLUSTER_NAME",
      "value": ""
    },
    {
      "name": "IMAGE_NAME",
      "value": ""
    },
    {
      "name": "NAMESPACE",
      "value": ""
    },
    {
      "name": "NEW_IMAGE",
      "value": ""
    },
    {
      "name": "K8S_CLUSTER_NAME",
      "value": ""
    },
    {
      "name": "HOST_NAME",
      "value": ""
    }
  ],
  "cells": [
    {
      "name": "cell_1",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Container Image Vulnerability on Kubernetes Cluster\nThis incident type refers to the discovery of a security vulnerability in a container image running on a Kubernetes cluster. Container images are commonly used to package and deploy software applications in a lightweight and portable way. Kubernetes is a popular platform for managing containerized applications. A vulnerability in a container image can potentially expose the application and the underlying infrastructure to security threats. This incident requires immediate attention to identify and remediate the vulnerability to prevent any further security breaches."
    },
    {
      "name": "cell_2",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check the status of the nodes in the cluster"
    },
    {
      "name": "cell_3",
      "type": "OP_LANG",
      "enabled": true,
      "content": "pod | k8s_cluster_name=$K8S_CLUSTER_NAME | app='shoreline' | limit=1 | random=1 | `kubectl get nodes`"
    },
    {
      "name": "cell_4",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check the status of the pods running in the cluster"
    },
    {
      "name": "cell_5",
      "type": "OP_LANG",
      "enabled": true,
      "content": "pod | k8s_cluster_name=$K8S_CLUSTER_NAME | app='shoreline' | limit=1 | random=1 | `kubectl get pods`"
    },
    {
      "name": "cell_6",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check the events related to a particular pod"
    },
    {
      "name": "cell_7",
      "type": "OP_LANG",
      "enabled": true,
      "content": "pod | k8s_cluster_name=$K8S_CLUSTER_NAME | app='shoreline' | limit=1 | random=1 | `kubectl describe pod ${POD_NAME}`"
    },
    {
      "name": "cell_8",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check the container image used by a pod"
    },
    {
      "name": "cell_9",
      "type": "OP_LANG",
      "enabled": true,
      "content": "pod | k8s_cluster_name=$K8S_CLUSTER_NAME | app='shoreline' | limit=1 | random=1 | `kubectl describe pod ${POD_NAME} | grep Image`"
    },
    {
      "name": "cell_10",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Check the vulnerabilities in a container image"
    },
    {
      "name": "cell_11",
      "type": "OP_LANG",
      "enabled": true,
      "content": "host | host_name=$HOST_NAME | invoke_install_trivy($IMAGE_NAME)"
    },
    {
      "name": "cell_12",
      "type": "MARKDOWN",
      "enabled": true,
      "content": "## Upgrade the container image to the latest version with the vulnerability patched or fixed."
    },
    {
      "name": "cell_13",
      "type": "OP_LANG",
      "enabled": true,
      "content": "pod | k8s_cluster_name=$K8S_CLUSTER_NAME | app='shoreline' | random=1 | limit=1 | invoke_upgrade_image($DEPLOYMENT, $NAMESPACE, $NEW_IMAGE)"
    }
  ]
}